<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>My Website</title>

    <!-- Load d3.js -->
    <script src="https://d3js.org/d3.v6.js"></script>

</head>

<body>
    <main>
        <h1>Welcome to My Website</h1>
        <!-- Add 2 buttons -->
        <!-- <button onclick="update('count')">Variable 1</button>
        <button onclick="update('count2')">Variable 2</button> -->

        <!-- Create a div where the graph will take place -->
        <div id="country_counts">
            <h2>Country Counts</h2>
        </div>
        <div id="yearwise_counts">
            <h2>Year wise enrolments </h2>
        </div>

    </main>
    <script src="index.js"></script>
</body>

</html>


<script>

// set the dimensions and margins of the graph
const margin = {top: 30, right: 30, bottom: 70, left: 60},
    width = 460 - margin.left - margin.right,
    height = 400 - margin.top - margin.bottom;

// append the svg object to the body of the page
const svg = d3.select("#country_counts")
  .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", `translate(${margin.left}, ${margin.top})`);

// Parse the Data
d3.csv("year_enrolment.csv").then ( function(data) {

data.forEach(function(d){ d['count'] = +d['count']; });
  // sort data
  data.sort(function(b, a) {
    return b.count - a.count;
  });

  // X axis
  const x = d3.scaleBand()
    .range([ 0, width ])
    .domain(data.map(d => d.year))
    .padding(0.2);
  svg.append("g")
    .attr("transform", `translate(0, ${height})`)
    .call(d3.axisBottom(x))
    .selectAll("text")
      .attr("transform", "translate(-10,0)rotate(-45)")
      .style("text-anchor", "end");

  // Add Y axis
  const y = d3.scaleLinear()
    .domain([0, 25000])
    .range([ height, 0]);
  svg.append("g")
    .call(d3.axisLeft(y));

  // Bars
svg.selectAll("mybar")
  .data(data)
  .enter()
  .append("rect")
    .attr("x", function(d) { return x(d.year); })
    .attr("width", x.bandwidth())
    .attr("fill", "#69b3a2")
    // no bar at the beginning thus:
    .attr("height", function(d) { return height - y(0); }) // always equal to 0
    .attr("y", function(d) { return y(0); })

      // Animation
svg.selectAll("rect")
  .transition()
  .duration(800)
  .attr("y", function(d) { return y(d.count); })
  .attr("height", function(d) { return height - y(d.count); })
  .delay(function(d,i){console.log(i) ; return(i*100)})

})


// append the svg object to the body of the page
svg = d3.select("#yearwise_counts")
  .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", `translate(${margin.left}, ${margin.top})`)



</script>